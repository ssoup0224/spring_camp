<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Detail</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
</head>

<body>
    USER DETAIL <br />
    deleted: <input class="input_param" id="input_deleted" name="deleted" readonly /> <br />
    id: <input class="input_param" id="input_id" name="id" readonly /> <br />
    createdAt: <input class="input_param" id="input_createdAt" name="createdAt" readonly /> <br />

    username: <input type="text" class="input_param" id="input_username" name="username" /> <br />
    password: <input type="password" class="input_param" id="input_password" name="password" /> <br />
    name: <input type="text" class="input_param" id="input_name" name="name" /> <br />
    nickname: <input type="text" class="input_param" id="input_nickname" name="nickname" /> <br />
    phone: <input type="text" class="input_param" id="input_phone" name="phone" /> <br />
    birthday: <input type="date" class="input_param" id="input_birthday" name="birthday" /> <br />
    gender: <select class="input_param" id="input_gender" name="gender">
        <option value="20">MALE</option>
        <option value="10">FEMALE</option>
    </select> <br />
    <button onclick="detail_user()">DETAIL</button>
    <button onclick="update_user()">UPDATE</button>
    <button onclick="delete_user()">DELETE</button>

    <script>
        let tempHref = location.href;
        let arrayHref = tempHref.split("/");
        let tempId = arrayHref[arrayHref.length - 1];
        if (tempId.includes("?")) {
            arrayHref = tempId.split("?");
            tempId = arrayHref[0];
        }

        function detail_user() {
            $.ajax({
                url: '/api/user',
                method: 'GET',
                data: {
                    id: tempId
                },
                success: function (data, status, xhr) {
                    // let result_status = data["status"];
                    alert("success : " + JSON.stringify(data));

                    let user = data;
                    let input_param = $(".input_param");
                    for (let each of input_param) {
                        let tempName = $(each).attr("name");
                        $(each).val(user[tempName]);
                    }
                },
                error: function (data, status, err) {
                },
                complete: function () {

                }
            });
        }
        function update_user() {
            let _param = {};
            let input_param = $(".input_param");
            for (let each of input_param) {
                let tempName = $(each).attr("name");
                if (tempName + "" !== "createdAt") {
                    _param[tempName] = $(each).val();
                }
            }

            $.ajax({
                url: '/api/user',
                method: 'PUT',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(_param),
                success: function (data, status, xhr) {
                    let result_status = data["status"];
                    alert("success : " + JSON.stringify(data));
                },
                error: function (data, status, err) {
                },
                complete: function () {

                }
            });
        }
        function delete_user() {
            $.ajax({
                url: '/api/user',
                method: 'DELETE',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify({
                    id: tempId
                }),
                success: function (data, status, xhr) {
                    let result_status = data["status"];
                    alert("success : " + JSON.stringify(data));
                    detail_posting();
                },
                error: function (data, status, err) {
                },
                complete: function () {

                }
            });
        }
    </script>
</body>

</html>